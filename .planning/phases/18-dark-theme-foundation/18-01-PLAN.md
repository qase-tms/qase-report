---
phase: 18-dark-theme-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/theme/index.ts
  - src/theme/ThemeRegistry.tsx
  - index.html
autonomous: false

must_haves:
  truths:
    - "Application loads with dark theme by default (no user action needed)"
    - "Light theme still accessible via toggle"
    - "Color palette uses dark grays (#121212, #1e1e1e) with professional accent colors"
    - "All existing components render correctly in new color scheme"
  artifacts:
    - path: "src/theme/index.ts"
      provides: "Dark palette customization in colorSchemes.dark"
      contains: "background.default: '#121212'"
    - path: "src/theme/ThemeRegistry.tsx"
      provides: "Dark mode as default via provider prop"
      contains: "defaultMode=\"dark\""
    - path: "index.html"
      provides: "FOWT prevention with dark default"
      contains: "var mode = savedMode || 'dark'"
  key_links:
    - from: "src/theme/ThemeRegistry.tsx"
      to: "index.html"
      via: "defaultMode must match FOWT script default"
      pattern: "defaultMode=\"dark\".*savedMode \\|\\| 'dark'"
---

<objective>
Set dark theme as default and customize color palette for Playwright-style aesthetic.

Purpose: v1.3 Design Overhaul starts with dark theme by default, matching modern developer tool aesthetics (VS Code, Playwright Smart Reporter). This creates the visual foundation for the redesign while keeping light theme accessible.

Output: Updated theme configuration with dark default and professional dark palette (#121212 background, #1e1e1e elevated surfaces).
</objective>

<execution_context>
@/Users/gda/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gda/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-dark-theme-foundation/18-RESEARCH.md
@.planning/phases/13-theme-foundation/13-01-SUMMARY.md
@src/theme/index.ts
@src/theme/ThemeRegistry.tsx
@index.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure dark theme as default with Playwright-style palette</name>
  <files>
    src/theme/index.ts
    src/theme/ThemeRegistry.tsx
    index.html
  </files>
  <action>
Update three files to make dark theme default and customize the dark palette:

**1. src/theme/index.ts** — Add dark palette customization:
```typescript
import { experimental_extendTheme as extendTheme } from '@mui/material/styles'

export const theme = extendTheme({
  colorSchemes: {
    light: {},  // Keep default light palette
    dark: {
      palette: {
        background: {
          default: '#121212',  // Material Design standard dark background
          paper: '#1e1e1e',    // Elevated surfaces (cards, dialogs)
        },
        // MUI default dark accent colors are already excellent:
        // primary.main: #90caf9 (light blue)
        // secondary.main: #ce93d8 (light purple)
        // No need to override - they follow Material Design dark mode guidelines
      },
    },
  },
})
```

**2. src/theme/ThemeRegistry.tsx** — Add `defaultMode="dark"` prop:
```typescript
import { PropsWithChildren } from 'react'
import { Experimental_CssVarsProvider as CssVarsProvider } from '@mui/material/styles'
import CssBaseline from '@mui/material/CssBaseline'
import { theme } from './index'

export const ThemeRegistry = ({ children }: PropsWithChildren) => {
  return (
    <CssVarsProvider theme={theme} defaultMode="dark">
      <CssBaseline />
      {children}
    </CssVarsProvider>
  )
}
```

**3. index.html** — Change FOWT script default from 'system' to 'dark':
Find line: `var mode = savedMode || 'system'`
Change to: `var mode = savedMode || 'dark'`

**CRITICAL:** FOWT script default MUST match defaultMode prop to prevent flash on first load.
  </action>
  <verify>
1. Run `npm run build` — must compile with no TypeScript errors
2. Run `npm run dev` and open http://localhost:5173 in incognito window (no localStorage)
3. Verify page loads in dark theme immediately (no flash of light theme)
4. Check DevTools console: `document.documentElement.getAttribute('data-mui-color-scheme')` returns 'dark'
5. Clear localStorage via DevTools, refresh — still loads dark theme
  </verify>
  <done>
- TypeScript compiles without errors
- Fresh browser session (incognito) loads dark theme by default
- No FOWT (flash of wrong theme) on initial load
- data-mui-color-scheme attribute is 'dark' when no saved preference
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify dark theme default and component rendering</name>
  <what-built>Dark theme as default with Playwright-style color palette. Light theme remains accessible via existing toggle.</what-built>
  <how-to-verify>
**Test 1: Dark theme is default**
1. Open incognito/private browser window
2. Navigate to http://localhost:5173
3. VERIFY: App loads in dark theme immediately (dark gray background #121212)
4. VERIFY: No white flash before dark theme appears

**Test 2: Light theme still works**
1. Click theme toggle icon in top-right corner
2. Select "Light" from menu
3. VERIFY: UI switches to light theme (white background)
4. Refresh page
5. VERIFY: Light theme persists (localStorage working)

**Test 3: System mode still works**
1. Click theme toggle, select "System"
2. VERIFY: Theme follows your OS dark mode preference
3. (If on macOS) Go to System Preferences > Appearance, switch between Light/Dark
4. VERIFY: App updates to match OS setting

**Test 4: All components render correctly in dark mode**
1. Switch back to dark mode
2. Open a test report file (load JSON)
3. Check Dashboard view — cards should have visible borders/shadows
4. Check TestList — text readable, status badges visible
5. Check TestDetails — steps and attachments render correctly
6. Check any charts — colors should contrast against dark background

**Expected appearance:**
- Background: Very dark gray (#121212), not pure black
- Cards/Paper: Slightly lighter gray (#1e1e1e)
- Text: White/light gray with good contrast
- Accent colors: Light blue (primary), light purple (secondary)
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe any visual issues found</resume-signal>
</task>

</tasks>

<verification>
Phase 18 is complete when:
1. `npm run build` succeeds with no errors
2. Application loads with dark theme by default (fresh browser, no localStorage)
3. No FOWT (flash of wrong theme) on initial page load
4. Light theme accessible via toggle and persists after selection
5. System mode works and follows OS preference
6. All existing components (Dashboard, TestList, TestDetails, charts) render correctly in dark mode
</verification>

<success_criteria>
- [THEME-04] Dark theme is default (light still available)
- [THEME-05] Color palette matches Playwright Smart Reporter style
- No regression in existing theme functionality (toggle, persistence, system mode)
- All UI components render correctly in new dark palette
</success_criteria>

<output>
After completion, create `.planning/phases/18-dark-theme-foundation/18-01-SUMMARY.md`
</output>
