---
phase: 31-core-ui-components
plan: 02
type: execute
wave: 2
depends_on: ["31-01"]
files_modified:
  - src/components/ui/badge.tsx
  - src/components/StatusBadge.tsx
autonomous: true

must_haves:
  truths:
    - "Badge variant='passed' displays green styling"
    - "Badge variant='failed' displays red styling"
    - "Badge variant='skipped' displays gray styling"
    - "Badge variant='broken' displays yellow styling"
    - "StatusBadge component accepts status string and renders correct variant"
    - "MobX observer components can use Badge without errors"
  artifacts:
    - path: "src/components/ui/badge.tsx"
      provides: "Badge component with passed/failed/skipped/broken variants"
      contains: "passed:"
    - path: "src/components/StatusBadge.tsx"
      provides: "StatusBadge component mapping test status to badge variant"
      exports: ["StatusBadge"]
  key_links:
    - from: "src/components/StatusBadge.tsx"
      to: "src/components/ui/badge.tsx"
      via: "Badge import"
      pattern: "import.*Badge.*from.*@/components/ui/badge"
    - from: "src/components/ui/badge.tsx"
      to: "class-variance-authority"
      via: "CVA for variants"
      pattern: "import.*cva.*from.*class-variance-authority"
---

<objective>
Extend Badge component with custom test status variants and create StatusBadge wrapper.

Purpose: Enable type-safe status display (passed, failed, skipped, broken) throughout the application.
Output: Extended Badge component with status variants and reusable StatusBadge component.
</objective>

<execution_context>
@/Users/gda/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gda/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/31-core-ui-components/31-RESEARCH.md
@src/components/ui/badge.tsx
@src/index.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add custom status variants to Badge component</name>
  <files>src/components/ui/badge.tsx</files>
  <action>
Modify the badgeVariants CVA configuration to add four custom test status variants.

Add these variants to the existing variants object in badgeVariants:

```typescript
// Custom test status variants (add after existing variants)
passed: "border-transparent bg-green-500/10 text-green-600 dark:text-green-400",
failed: "border-transparent bg-red-500/10 text-red-600 dark:text-red-400",
skipped: "border-transparent bg-gray-500/10 text-gray-600 dark:text-gray-400",
broken: "border-transparent bg-yellow-500/10 text-yellow-700 dark:text-yellow-400",
```

Note: This project uses dark-first theme (:root = dark, .light = light), so the base colors (text-green-600) will show in light theme, and dark: variants will apply in the default dark theme. The `/10` and `/20` opacity modifiers create subtle backgrounds that work in both themes.

Ensure the BadgeProps type uses VariantProps<typeof badgeVariants> so TypeScript knows about the new variants.
  </action>
  <verify>
```bash
cat src/components/ui/badge.tsx | grep -A 2 "passed:"
npx tsc --noEmit
```
Shows passed variant definition, TypeScript compiles.
  </verify>
  <done>
Badge component has passed, failed, skipped, broken variants with correct dark-theme-aware colors.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create StatusBadge wrapper component</name>
  <files>src/components/StatusBadge.tsx</files>
  <action>
Create a StatusBadge component that maps test status strings to Badge variants.

```typescript
// src/components/StatusBadge.tsx
import { Badge } from '@/components/ui/badge'

export type TestStatus = 'passed' | 'failed' | 'skipped' | 'broken'

interface StatusBadgeProps {
  status: TestStatus
  className?: string
}

export function StatusBadge({ status, className }: StatusBadgeProps) {
  return (
    <Badge variant={status} className={className}>
      {status.charAt(0).toUpperCase() + status.slice(1)}
    </Badge>
  )
}
```

This provides:
1. Type-safe status prop (only valid statuses accepted)
2. Automatic capitalization of status text
3. Direct mapping to badge variants
4. Optional className for additional styling

Note: This is NOT an MobX observer component because it receives status as a prop (primitive value), not an observable object. The parent component that reads from MobX store should be the observer.
  </action>
  <verify>
```bash
cat src/components/StatusBadge.tsx
npx tsc --noEmit
```
File exists with correct implementation, TypeScript compiles.
  </verify>
  <done>
StatusBadge component created with type-safe status prop and proper Badge variant mapping.
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify MobX observer compatibility</name>
  <files>None (verification only)</files>
  <action>
Create a simple test to verify Badge works inside MobX observer components.

The verification approach:
1. Check that Badge has no internal state that conflicts with MobX
2. Verify imports work correctly with observer pattern
3. Ensure TypeScript understands variant types in observer context

Run the build to confirm no runtime issues with observer + Badge combination:

```bash
npm run build
```

The key compatibility points are:
- Badge uses only props (no internal useState/useEffect that could conflict)
- CVA variants are pure functions (no side effects)
- className merging via cn() is deterministic

No code changes needed - this task confirms the architectural compatibility documented in research:
- shadcn/ui handles presentation layer
- MobX handles reactivity layer
- They operate at different levels with no conflicts
  </action>
  <verify>
```bash
npm run build && echo "MobX observer compatibility verified"
```
Build succeeds, confirming no conflicts between Badge component and MobX patterns.
  </verify>
  <done>
Badge component works with MobX observer pattern - build succeeds, no conflicts.
  </done>
</task>

</tasks>

<verification>
1. Badge component has four status variants (passed, failed, skipped, broken)
2. StatusBadge component exists with TestStatus type export
3. TypeScript compiles with variant autocomplete working
4. Production build succeeds
5. Dark theme colors work correctly (green-400, red-400, etc. for dark mode)
</verification>

<success_criteria>
- Badge component extended with passed/failed/skipped/broken variants
- StatusBadge wrapper component created with type-safe status prop
- All variants use dark-theme-aware colors (dark: modifier)
- TypeScript provides autocomplete for variant prop
- MobX observer compatibility confirmed via successful build
</success_criteria>

<output>
After completion, create `.planning/phases/31-core-ui-components/31-02-SUMMARY.md`
</output>
