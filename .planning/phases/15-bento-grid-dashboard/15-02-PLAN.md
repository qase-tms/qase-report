---
phase: 15-bento-grid-dashboard
plan: 02
type: execute
wave: 2
depends_on: ["15-01"]
files_modified:
  - src/components/Dashboard/SparklineCard.tsx
  - src/components/Dashboard/ProgressRingCard.tsx
  - src/components/Dashboard/index.tsx
autonomous: true

must_haves:
  truths:
    - "Dashboard shows sparkline charts without visible axes"
    - "Dashboard shows circular progress ring for pass rate"
    - "Progress ring displays percentage number in center"
    - "Sparklines show pass rate trend data over time"
    - "Progress ring color reflects pass rate (green for high, yellow for medium, red for low)"
  artifacts:
    - path: "src/components/Dashboard/SparklineCard.tsx"
      provides: "Minimal Recharts line chart without axes"
      exports: ["SparklineCard"]
    - path: "src/components/Dashboard/ProgressRingCard.tsx"
      provides: "MUI CircularProgress with centered percentage"
      exports: ["ProgressRingCard"]
    - path: "src/components/Dashboard/index.tsx"
      provides: "Dashboard with micro-visualizations integrated"
      contains: "SparklineCard"
  key_links:
    - from: "src/components/Dashboard/SparklineCard.tsx"
      to: "recharts"
      via: "LineChart without XAxis/YAxis"
      pattern: "LineChart.*Line"
    - from: "src/components/Dashboard/ProgressRingCard.tsx"
      to: "@mui/material"
      via: "CircularProgress determinate variant"
      pattern: "CircularProgress.*determinate"
    - from: "src/components/Dashboard/index.tsx"
      to: "src/store/AnalyticsStore"
      via: "passRateTrend data for sparkline"
      pattern: "analyticsStore\\.passRateTrend"
---

<objective>
Add micro-visualizations to dashboard cards: sparklines for trend data and progress rings for pass rate.

Purpose: Transform plain number cards into data-rich visualizations that communicate trends and status at a glance - key Bento Grid pattern for information density.

Output: SparklineCard component, ProgressRingCard component, Dashboard integration with real data.
</objective>

<execution_context>
@/Users/gda/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gda/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/15-bento-grid-dashboard/15-RESEARCH.md
@.planning/phases/15-bento-grid-dashboard/15-01-SUMMARY.md

# TrendsChart has Recharts patterns to follow
@src/components/Dashboard/TrendsChart.tsx
# Store provides trend data
@src/store/AnalyticsStore.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SparklineCard component</name>
  <files>src/components/Dashboard/SparklineCard.tsx</files>
  <action>
Create SparklineCard.tsx - Minimal Recharts line chart for trend visualization.

Implementation:
1. Import from recharts: LineChart, Line, ResponsiveContainer, Tooltip (NO XAxis, NO YAxis)
2. Import useTheme from @mui/material for theme-aware colors
3. Import DashboardCard from ./DashboardCard

Props interface:
```typescript
interface SparklineCardProps {
  title: string
  data: Array<{ value: number; label?: string }>
  dataKey?: string  // default: 'value'
  color?: string    // default: theme.palette.primary.main
  colSpan?: number  // default: 2
  rowSpan?: number  // default: 1
  currentValue?: string | number  // Optional large display value
}
```

Component structure:
- Wrap in DashboardCard with passed colSpan/rowSpan
- Typography caption for title (color="text.secondary")
- If currentValue provided, show Typography variant="h4" below title
- ResponsiveContainer width="100%" height={60}
- LineChart without margins (margin={{ top: 5, right: 5, bottom: 5, left: 5 }})
- Line with: type="monotone", strokeWidth={2}, dot={false}, isAnimationActive={false}
- Tooltip with minimal styling (fontSize: '0.75rem'), cursor={false}

CRITICAL: Do NOT include XAxis or YAxis components - omit entirely (not hide={true}).
  </action>
  <verify>
File exists at src/components/Dashboard/SparklineCard.tsx.
`grep -n "XAxis" src/components/Dashboard/SparklineCard.tsx` returns NO matches.
`grep -n "YAxis" src/components/Dashboard/SparklineCard.tsx` returns NO matches.
`grep -n "LineChart" src/components/Dashboard/SparklineCard.tsx` returns match.
  </verify>
  <done>SparklineCard component exported with minimal Recharts chart (no axes), theme-aware colors, and responsive sizing.</done>
</task>

<task type="auto">
  <name>Task 2: Create ProgressRingCard component</name>
  <files>src/components/Dashboard/ProgressRingCard.tsx</files>
  <action>
Create ProgressRingCard.tsx - Circular progress with centered percentage.

Implementation:
1. Import: Box, CircularProgress, Typography from @mui/material
2. Import DashboardCard from ./DashboardCard

Props interface:
```typescript
interface ProgressRingCardProps {
  title: string
  value: number        // 0-100 percentage
  size?: number        // default: 100 (pixels)
  thickness?: number   // default: 4
  colSpan?: number     // default: 1
  rowSpan?: number     // default: 1
}
```

Color logic based on value (use sx prop, not color prop for custom colors):
- value >= 80: 'success.main' (green)
- value >= 50: 'warning.main' (yellow)
- value < 50: 'error.main' (red)

Component structure (per research Pattern 4):
```tsx
<DashboardCard colSpan={colSpan} rowSpan={rowSpan}>
  <Typography variant="caption" color="text.secondary" gutterBottom>
    {title}
  </Typography>
  <Box sx={{ display: 'flex', justifyContent: 'center', mt: 1 }}>
    <Box sx={{ position: 'relative', display: 'inline-flex' }}>
      {/* Background ring (track) */}
      <CircularProgress
        variant="determinate"
        value={100}
        size={size}
        thickness={thickness}
        sx={{ color: 'action.hover' }}
      />
      {/* Foreground ring (progress) */}
      <CircularProgress
        variant="determinate"
        value={value}
        size={size}
        thickness={thickness}
        sx={{
          position: 'absolute',
          left: 0,
          color: getColor(value),
        }}
      />
      {/* Centered percentage label */}
      <Box
        sx={{
          position: 'absolute',
          top: 0, left: 0, bottom: 0, right: 0,
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
        }}
      >
        <Typography variant="h5" component="div">
          {Math.round(value)}%
        </Typography>
      </Box>
    </Box>
  </Box>
</DashboardCard>
```

Use two CircularProgress stacked for background track effect.
  </action>
  <verify>
File exists at src/components/Dashboard/ProgressRingCard.tsx.
`grep -n "CircularProgress" src/components/Dashboard/ProgressRingCard.tsx` returns match.
`grep -n "determinate" src/components/Dashboard/ProgressRingCard.tsx` returns match.
`grep -n "position: 'absolute'" src/components/Dashboard/ProgressRingCard.tsx` returns match (centered label).
  </verify>
  <done>ProgressRingCard component exported with dual CircularProgress (track + progress), centered percentage label, and color coding by value.</done>
</task>

<task type="auto">
  <name>Task 3: Integrate micro-visualizations into Dashboard</name>
  <files>src/components/Dashboard/index.tsx</files>
  <action>
Update Dashboard/index.tsx to use SparklineCard and ProgressRingCard.

Changes:
1. Import SparklineCard and ProgressRingCard
2. Add ProgressRingCard for pass rate (replaces or supplements stats display):
   - colSpan={1}, rowSpan={1}
   - title="Pass Rate"
   - value={reportStore.passRate}
   - Position in grid after main stats cards

3. Add SparklineCard for pass rate trend (when trend data available):
   - colSpan={2}, rowSpan={1}
   - title="Pass Rate Trend"
   - data={analyticsStore.passRateTrend.map(d => ({ value: d.passRate, label: d.date }))}
   - currentValue={`${reportStore.passRate.toFixed(0)}%`}
   - Only render if analyticsStore.hasTrendData

4. Optionally add SparklineCard for duration trend:
   - colSpan={2}, rowSpan={1}
   - title="Duration Trend"
   - data={analyticsStore.durationTrend.map(d => ({ value: d.duration / 1000, label: d.date }))}
   - Only render if analyticsStore.hasTrendData

Updated grid layout (within single BentoGrid):
- Row 1: 4 StatsCards (1x1 each) + ProgressRingCard (1x1) + SparklineCard (2x1 if trend data)
- Row 2: RunInfoCard (2x1) + HostInfoCard (2x1) + Duration SparklineCard (2x1 if trend data)
- Conditional: AlertsPanel (3x1), TrendsChart (4x2), TestHealthWidget (2x2), HistoryTimeline (2x2)

Keep existing TrendsChart (full detailed charts) for users who want more detail.
The sparklines are overview/summary, TrendsChart is detailed view.
  </action>
  <verify>
`npm run build` succeeds without errors.
`grep -n "SparklineCard" src/components/Dashboard/index.tsx` shows import and usage.
`grep -n "ProgressRingCard" src/components/Dashboard/index.tsx` shows import and usage.
  </verify>
  <done>Dashboard displays sparklines for trend data and progress ring for pass rate, integrated with existing widgets in Bento Grid layout.</done>
</task>

</tasks>

<verification>
1. Run `npm run build` - should complete without errors
2. Run `npm run dev` and open browser with test data
3. Verify pass rate progress ring visible with:
   - Circular indicator
   - Percentage number centered inside
   - Color matches rate (green if high, etc.)
4. Load history data to enable trend visualization
5. Verify sparkline card shows:
   - Small line chart without axis labels
   - Trend line reflecting data
   - Title above chart
6. Hover on sparkline to confirm tooltip appears
</verification>

<success_criteria>
- SparklineCard.tsx exists with Recharts LineChart (no XAxis/YAxis)
- ProgressRingCard.tsx exists with CircularProgress and centered label
- Dashboard shows progress ring for pass rate
- Dashboard shows sparklines when trend data available
- Progress ring color reflects pass rate threshold
- Build passes, no TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/15-bento-grid-dashboard/15-02-SUMMARY.md`
</output>
